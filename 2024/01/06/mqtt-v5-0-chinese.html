

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="vc">
  <meta name="keywords" content="">
  
    <meta name="description" content=":root {       --vc-marked: #ffc107;       --vc-referred: #EE0000;     }     [data-user-color-scheme&#x3D;&quot;dark&quot;] {       --vc-marked: #886c57;       --vc-referred: #EE0000;     }     .bold {">
<meta property="og:type" content="article">
<meta property="og:title" content="MQTT 5.0 中文文档(施工中)">
<meta property="og:url" content="https://vitsumoc.github.io/2024/01/06/mqtt-v5-0-chinese.html">
<meta property="og:site_name" content="Thinking...">
<meta property="og:description" content=":root {       --vc-marked: #ffc107;       --vc-referred: #EE0000;     }     [data-user-color-scheme&#x3D;&quot;dark&quot;] {       --vc-marked: #886c57;       --vc-referred: #EE0000;     }     .bold {">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-01-06T02:14:39.000Z">
<meta property="article:modified_time" content="2024-01-07T10:48:08.288Z">
<meta property="article:author" content="vc">
<meta property="article:tag" content="MQTT">
<meta property="article:tag" content="网络协议">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>MQTT 5.0 中文文档(施工中) - Thinking...</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"vitsumoc.github.io","root":"/","version":"1.9.6","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":3},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Thinking...</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">MQTT 5.0 中文文档(施工中)</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-01-06 10:14" pubdate>
          2024年1月6日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          5.4k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          46 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MQTT 5.0 中文文档(施工中)</h1>
            
            
              <div class="markdown-body">
                
                <head>
  <style>
    :root {
      --vc-marked: #ffc107;
      --vc-referred: #EE0000;
    }
    [data-user-color-scheme="dark"] {
      --vc-marked: #886c57;
      --vc-referred: #EE0000;
    }
    .bold {
      font-weight: bold;
    }
    .vcLinked {
      color: var(--post-link-color);
    }
    .vcMarked {
      background: var(--vc-marked);
    }
    .vcReferred {
      color: var(--vc-referred);
    }
  </style>
</head>

<blockquote>
<p>原文 <a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html">MQTT Version 5.0</a><br><strong>[mqtt-v5.0]</strong><br>MQTT Version 5.0. Edited by Andrew Banks, Ed Briggs, Ken Borgendale, and Rahul Gupta. 07 March 2019. OASIS Standard. <a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html">https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html</a>. Latest version: <a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html">https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html</a>.</p>
</blockquote>
<span id="more"></span>

<h1 id="MQTT-5-0"><a href="#MQTT-5-0" class="headerlink" title="MQTT 5.0"></a>MQTT 5.0</h1><p>OASIS 标准</p>
<p>2019年3月7日</p>
<h2 id="规范-URIs"><a href="#规范-URIs" class="headerlink" title="规范 URIs"></a>规范 URIs</h2><h3 id="此版本"><a href="#此版本" class="headerlink" title="此版本"></a>此版本</h3><p><a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.docx">https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.docx</a> (权威性)<br><a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html">https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html</a><br><a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.pdf">https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.pdf</a></p>
<h3 id="前一版本"><a href="#前一版本" class="headerlink" title="前一版本"></a>前一版本</h3><p><a target="_blank" rel="noopener" href="http://docs.oasis-open.org/mqtt/mqtt/v5.0/cos01/mqtt-v5.0-cos01.docx">http://docs.oasis-open.org/mqtt/mqtt/v5.0/cos01/mqtt-v5.0-cos01.docx</a> (权威性)<br><a target="_blank" rel="noopener" href="http://docs.oasis-open.org/mqtt/mqtt/v5.0/cos01/mqtt-v5.0-cos01.html">http://docs.oasis-open.org/mqtt/mqtt/v5.0/cos01/mqtt-v5.0-cos01.html</a><br><a target="_blank" rel="noopener" href="http://docs.oasis-open.org/mqtt/mqtt/v5.0/cos01/mqtt-v5.0-cos01.pdf">http://docs.oasis-open.org/mqtt/mqtt/v5.0/cos01/mqtt-v5.0-cos01.pdf</a></p>
<h3 id="最新版本"><a href="#最新版本" class="headerlink" title="最新版本"></a>最新版本</h3><p><a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.docx">https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.docx</a> (权威性)<br><a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html">https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html</a><br><a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.pdf">https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.pdf</a></p>
<h3 id="技术委员会"><a href="#技术委员会" class="headerlink" title="技术委员会"></a>技术委员会</h3><p><a target="_blank" rel="noopener" href="https://www.oasis-open.org/committees/mqtt/">OASIS Message Queuing Telemetry Transport (MQTT) TC</a></p>
<h3 id="主席"><a href="#主席" class="headerlink" title="主席"></a>主席</h3><p>Richard Coppen (<a href="mailto:&#99;&#x6f;&#112;&#112;&#101;&#x6e;&#64;&#117;&#x6b;&#46;&#105;&#98;&#x6d;&#46;&#99;&#111;&#109;">&#99;&#x6f;&#112;&#112;&#101;&#x6e;&#64;&#117;&#x6b;&#46;&#105;&#98;&#x6d;&#46;&#99;&#111;&#109;</a>), <a target="_blank" rel="noopener" href="http://www.ibm.com/">IBM</a></p>
<h3 id="编辑"><a href="#编辑" class="headerlink" title="编辑"></a>编辑</h3><p>Andrew Banks (<a href="mailto:&#x61;&#110;&#100;&#114;&#101;&#119;&#x5f;&#98;&#x61;&#x6e;&#107;&#x73;&#x40;&#x75;&#107;&#x2e;&#105;&#x62;&#109;&#46;&#99;&#111;&#109;">&#x61;&#110;&#100;&#114;&#101;&#119;&#x5f;&#98;&#x61;&#x6e;&#107;&#x73;&#x40;&#x75;&#107;&#x2e;&#105;&#x62;&#109;&#46;&#99;&#111;&#109;</a>), <a target="_blank" rel="noopener" href="http://www.ibm.com/">IBM</a><br>Ed Briggs (<a href="mailto:&#101;&#x64;&#x62;&#114;&#105;&#103;&#103;&#x73;&#x40;&#109;&#x69;&#99;&#114;&#x6f;&#x73;&#111;&#102;&#x74;&#x2e;&#x63;&#x6f;&#x6d;">&#101;&#x64;&#x62;&#114;&#105;&#103;&#103;&#x73;&#x40;&#109;&#x69;&#99;&#114;&#x6f;&#x73;&#111;&#102;&#x74;&#x2e;&#x63;&#x6f;&#x6d;</a>), <a target="_blank" rel="noopener" href="http://www.microsoft.com/">Microsoft</a><br>Ken Borgendale (<a href="mailto:&#107;&#x77;&#98;&#64;&#x75;&#x73;&#46;&#105;&#98;&#109;&#x2e;&#x63;&#x6f;&#109;">&#107;&#x77;&#98;&#64;&#x75;&#x73;&#46;&#105;&#98;&#109;&#x2e;&#x63;&#x6f;&#109;</a>), <a target="_blank" rel="noopener" href="http://www.ibm.com/">IBM</a><br>Rahul Gupta (<a href="mailto:&#x72;&#x61;&#x68;&#117;&#x6c;&#x2e;&#x67;&#x75;&#112;&#x74;&#97;&#64;&#117;&#115;&#x2e;&#105;&#x62;&#109;&#46;&#x63;&#x6f;&#109;">&#x72;&#x61;&#x68;&#117;&#x6c;&#x2e;&#x67;&#x75;&#112;&#x74;&#97;&#64;&#117;&#115;&#x2e;&#105;&#x62;&#109;&#46;&#x63;&#x6f;&#109;</a>), <a target="_blank" rel="noopener" href="http://www.ibm.com/">IBM</a></p>
<h3 id="相关工作"><a href="#相关工作" class="headerlink" title="相关工作"></a>相关工作</h3><p>本规范取代：</p>
<ul>
<li><em>MQTT 3.1.1</em>  由 Andrew Banks 和 Rahul Gupta 编辑发布与 2014年10月29日。 OASIS 标准 <a target="_blank" rel="noopener" href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html">http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html</a> 最新版本：<a target="_blank" rel="noopener" href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/mqtt-v3.1.1.html">http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/mqtt-v3.1.1.html</a></li>
</ul>
<p>本规范涉及：</p>
<ul>
<li><em>MQTT and the NIST Cybersecurity Framework Version 1.0</em> 由 Geoff Brown 和 Louis-Philippe Lamoureux 编辑发布。最新版本： <a target="_blank" rel="noopener" href="http://docs.oasis-open.org/mqtt/mqtt-nist-cybersecurity/v1.0/mqtt-nist-cybersecurity-v1.0.html">http://docs.oasis-open.org/mqtt/mqtt-nist-cybersecurity/v1.0/mqtt-nist-cybersecurity-v1.0.html</a></li>
</ul>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>MQTT 是一个 客户端&#x2F;服务器 架构，采用 订阅&#x2F;发布 模式的消息传输协议。是一套轻量级的、开放的、简单且易于实现的标准。这些特性使得他适用于多种场景，包括一些资源受限的场景比如机器和机器之间的通信（M2M）或是物联网（IoT）场景，这些场景要求较小的代码空间占用，或是网络带宽非常珍贵。</p>
<p>MQTT 基于 TCP&#x2F;IP 或其他提供了顺序、无报文丢失、双向链接的网络协议。MQTT 的特性包括：</p>
<ul>
<li>通过 订阅&#x2F;发布 模式实现一对多的消息传输和应用程序解耦。</li>
<li>与负载内容无关的消息传输。</li>
<li>三种不同服务质量(QoS)的消息传输：<ul>
<li>至多一次(At most once)，根据操作环境情况尽最大努力来传输消息，消息可能会丢失。例如这种模式可以用于传感器数据采集，单次的消息的丢失并不重要，因为下一个消息很快就会到来。</li>
<li>至少一次(At least once)，可以确保消息到达，但是可能会造成消息重复。</li>
<li>确保一次(Exactly once)，可以确保消息只到达一次，例如这种消息可以用于账单交易信息，在交易场景下消息的丢失或者重复处理都会带来糟糕的后果。</li>
</ul>
</li>
<li>小型的协议头，用来降低网络负载。</li>
<li>当发生异常断开时通知相关方的机制。</li>
</ul>
<h3 id="状态"><a href="#状态" class="headerlink" title="状态"></a>状态</h3><p>本文档最后一次修订的日期和级别都已经在前文中描述。检查<a href="#%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC">最新版本</a>位置了解本文档后续可能的修订版。技术委员会(TC)制作的其他版本文档或其他技术项目均在此提供 <a target="_blank" rel="noopener" href="https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=mqtt#technical">https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=mqtt#technical</a></p>
<p>技术委员会成员应将对此文档的评论发送至技术委员会邮件列表，其他人需在技术委员会的网站(<a target="_blank" rel="noopener" href="https://www.oasis-open.org/committees/mqtt/)%E8%AE%A2%E9%98%85%E5%85%AC%E5%85%B1%E8%AF%84%E8%AE%BA%E5%88%97%E8%A1%A8%E5%90%8E%EF%BC%8C%E9%80%9A%E8%BF%87%E7%82%B9%E5%87%BB[%E5%8F%91%E9%80%81%E8%AF%84%E8%AE%BA](https://www.oasis-open.org/committees/comments/index.php?wg_abbrev=mqtt)%E5%B0%86%E8%AF%84%E8%AE%BA%E5%8F%91%E9%80%81%E8%87%B3%E5%85%AC%E5%85%B1%E8%AF%84%E8%AE%BA%E5%88%97%E8%A1%A8%E3%80%82">https://www.oasis-open.org/committees/mqtt/)订阅公共评论列表后，通过点击[发送评论](https://www.oasis-open.org/committees/comments/index.php?wg_abbrev=mqtt)将评论发送至公共评论列表。</a></p>
<p>本规范是在 OASIS <a target="_blank" rel="noopener" href="https://www.oasis-open.org/policies-guidelines/ipr">知识产权政策</a>的 <a target="_blank" rel="noopener" href="https://www.oasis-open.org/policies-guidelines/ipr#Non-Assertion-Mode">Non-Assertion</a>模式下提供的，该模式是技术委员会成立时选择的。关于是否有实施本规范依赖的已经披露的专利信息或是关于任何专利许可条款的信息，请参考技术委员会网站中的知识产权部分(<a target="_blank" rel="noopener" href="https://www.oasis-open.org/committees/mqtt/ipr.php)%E3%80%82">https://www.oasis-open.org/committees/mqtt/ipr.php)。</a></p>
<p>请注意，本工作产品声明为规范的任何机器可读内容（<a target="_blank" rel="noopener" href="https://www.oasis-open.org/policies-guidelines/tc-process#wpComponentsCompLang">计算机语言定义</a>）均以单独的纯文本文件提供。 如果任何此类纯文本文件与工作产品的散文叙述性文档中的显示内容之间存在差异，则以单独的纯文本文件中的内容为准。</p>
<h3 id="引用格式"><a href="#引用格式" class="headerlink" title="引用格式"></a>引用格式</h3><p>引用本规范时，需要使用如下引用格式：</p>
<p><strong>[mqtt-v5.0]</strong></p>
<p>MQTT Version 5.0. Edited by Andrew Banks, Ed Briggs, Ken Borgendale, and Rahul Gupta. 07 March 2019. OASIS Standard. <a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html">https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html</a>. Latest version: <a target="_blank" rel="noopener" href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html">https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html</a>.</p>
<h1 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h1><p>Copyright © OASIS Open 2019. All Rights Reserved.</p>
<p>以下文本中所有 <code>大写</code> 术语均具有 <code>OASIS</code> 知识产权政策（the <code>OASIS IPR Policy</code>）中指定的含义。 完整的<a target="_blank" rel="noopener" href="https://www.oasis-open.org/policies-guidelines/ipr">政策</a>可以在 <code>OASIS</code> 网站上找到。</p>
<p>本文档及其一本可以被复制并提供给其他人，本文档的原文或对本文档的部分引用、评论、解释说明等衍生品的制作、复制、出版和分发均没有限制，但上述许可的前提条件是上述的版权说明和本节内容必须包括在此类副本和衍生品内。并且，对于本文档本身的内容不得做任何修改，包括删除版权申明或对 <code>OASIS</code> 的引用，除非是为了 <code>OASIS</code> 技术委员会为了制作某些文件或者交付成果的需要（在这种情况下，必须遵守 OASIS 知识产权政策中规定的适用于版权的规则）或是将本文档翻译为英语之外的其他语言。</p>
<p>上述授予的有限权限是永久性的，<code>OASIS</code> 或其继承者或受让人不会撤销。</p>
<p>本文档和此处包含的信息均按<code>原样</code>提供，<code>OASIS 不承担任何明示或暗示的保证，包括但不限于使用此处信息不会侵犯任何所有权的任何保证或任何暗示的保证商用能力或特定用途的适用性</code>。</p>
<p><code>OASIS</code> 要求任何 <code>OASIS</code> 方或任何其他方认为其专利主张必然会因实施本 <code>OASIS</code> 委员会规范或 <code>OASIS</code> 标准而受到侵犯时，通知 OASIS 技术委员会管理员并表明其愿意向此类人员授予专利许可。 专利权利要求的方式与制定本规范的 <code>OASIS</code> 技术委员会的 IPR 模式一致。</p>
<p><code>OASIS</code> 邀请任何一方联系 <code>OASIS</code> 技术委员会管理员，如果它知道任何专利权利要求的所有权主张，如果专利持有者不愿意使用与制定本规范的 <code>OASIS</code> 技术委员会的 <code>IPR</code> 模式一致的方式。 <code>OASIS</code> 可能会在其网站上包含此类声明，但不承担任何这样做的义务。</p>
<p>对于可能声称与本文档中描述的技术的实施或使用有关的任何知识产权或其他权利的有效性或范围，或者此类权利下的任何许可可能或可能不可用的范围，<code>OASIS</code> 不持任何立场 ; 他也不代表他已做出任何努力来确定任何此类权利。 有关 <code>OASIS</code> 与 <code>OASIS</code> 技术委员会制定的任何文件或交付物的权利有关的程序的信息，请参见 <code>OASIS</code> 网站。 可供发布的权利主张的副本以及可供使用的许可证的任何保证，或者本 <code>OASIS</code> 委员会规范的实施者或用户尝试获得使用此类专有权利的一般许可证或许可的结果，或 <code>OASIS</code> 标准，可从 <code>OASIS</code> 技术委员会管理员处获取。 <code>OASIS</code> 不声明任何信息或知识产权列表在任何时候都是完整的，也不声明该列表中的任何权利要求实际上是基本权利要求。</p>
<p>名称<code>“OASIS”</code>是 <code>OASIS</code>（本规范的所有者和开发者）的商标，仅用于指代该组织及其官方输出。 <code>OASIS</code> 欢迎参考、实施和使用规范，同时保留强制执行其标记以防止误导性使用的权利。 请参阅 <a target="_blank" rel="noopener" href="https://www.oasis-open.org/policies-guidelines/trademark">https://www.oasis-open.org/policies-guidelines/trademark</a> 了解上述指南。</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ul>
<li>1 <a href="#1-%E4%BB%8B%E7%BB%8D">介绍</a><ul>
<li>1.0 <a href="#1-0-%E7%9F%A5%E8%AF%86%E4%BA%A7%E6%9D%83%E6%94%BF%E7%AD%96">知识产权政策</a></li>
<li>1.1 <a href="#1-1-MQTT%E8%A7%84%E8%8C%83%E7%BB%93%E6%9E%84">MQTT规范结构</a></li>
<li>1.2 <a href="#1-2-%E6%9C%AF%E8%AF%AD%E8%A1%A8">术语表</a></li>
<li>1.3 <a href="#1-3-%E8%A7%84%E8%8C%83%E6%80%A7%E5%BC%95%E7%94%A8">规范性引用</a></li>
<li>1.4 <a href="#1-4-%E9%9D%9E%E8%A7%84%E8%8C%83%E6%80%A7%E5%BC%95%E7%94%A8">非规范性引用</a></li>
<li>1.5 <a href="#1-5-%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%A4%BA">数据表示</a><ul>
<li>1.5.1 <a href="#1-5-1-%E6%AF%94%E7%89%B9%E4%BD%8D">比特位</a></li>
<li>1.5.2 <a href="#1-5-2-2%E5%AD%97%E8%8A%82%E6%95%B4%E6%95%B0">2字节整数</a></li>
<li>1.5.3 <a href="#1-5-3-4%E5%AD%97%E8%8A%82%E6%95%B4%E6%95%B0">4字节整数</a></li>
<li>1.5.4 <a href="#1-5-4-UTF-8%E5%AD%97%E7%AC%A6%E4%B8%B2">UTF-8字符串</a></li>
<li>1.5.5 <a href="#1-5-5-%E5%8F%98%E9%95%BF%E6%95%B4%E6%95%B0">变长整数</a></li>
<li>1.5.6 <a href="#1-5-6-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE">二进制数据</a></li>
<li>1.5.7 <a href="#1-5-7-UTF-8%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AF%B9">UTF-8字符串对</a></li>
</ul>
</li>
<li>1.6 <a href="#1-6-%E5%AE%89%E5%85%A8%E6%80%A7">安全性</a></li>
<li>1.7 <a href="#1-7-%E7%BC%96%E8%BE%91%E7%BA%A6%E5%AE%9A">编辑约定</a></li>
<li>1.8 <a href="#1-8-%E5%8F%98%E6%9B%B4%E5%8E%86%E5%8F%B2">变更历史</a><ul>
<li>1.8.1 <a href="#1-8-1-MQTT-v3-1-1">MQTT v3.1.1</a></li>
<li>1.8.2 <a href="#1-8-2-MQTT-v5-0">MQTT v5.0</a></li>
</ul>
</li>
</ul>
</li>
<li>2 <a href="#2-MQTT%E5%8C%85%E6%A0%BC%E5%BC%8F">MQTT包格式</a><ul>
<li>2.1 <a href="#2-1-MQTT%E5%8C%85%E7%BB%93%E6%9E%84">MQTT包结构</a><ul>
<li>2.1.1 <a href="#2-1-1-%E5%9B%BA%E5%AE%9A%E5%A4%B4">固定头</a></li>
<li>2.1.2 <a href="#2-1-2-MQTT%E5%8C%85%E7%B1%BB%E5%9E%8B">MQTT包类型</a></li>
<li>2.1.3 <a href="2-1-3-%E6%8E%A7%E5%88%B6%E6%A0%87%E8%AF%86">控制标识</a></li>
<li>2.1.4 <a href="#2-1-4-%E5%89%A9%E4%BD%99%E9%95%BF%E5%BA%A6">剩余长度</a></li>
</ul>
</li>
<li>2.2 <a href="#2-2-%E5%8F%AF%E5%8F%98%E5%A4%B4">可变头</a><ul>
<li>2.2.1 <a href="#2-2-1-%E5%8C%85ID">包ID</a></li>
<li>2.2.2 Properties<ul>
<li>2.2.2.1 Property Length</li>
<li>2.2.2.2 Property</li>
</ul>
</li>
</ul>
</li>
<li>2.3 Payload</li>
<li>2.4 Reason Code</li>
</ul>
</li>
<li>3 <a href="#3-MQTT%E5%8C%85">MQTT包</a><ul>
<li>3.1 CONNECT – Connection Request<ul>
<li>3.1.1 CONNECT Fixed Header</li>
<li>3.1.2 CONNECT Variable Header<ul>
<li>3.1.2.1 Protocol Name</li>
<li>3.1.2.2 Protocol Version</li>
<li>3.1.2.3 Connect Flags</li>
<li>3.1.2.4 Clean Start</li>
<li>3.1.2.5 <a href="#3-1-2-5-%E9%81%97%E5%98%B1%E6%A0%87%E8%AF%86">遗嘱标识</a></li>
<li>3.1.2.6 Will QoS</li>
<li>3.1.2.7 Will Retain</li>
<li>3.1.2.8 User Name Flag</li>
<li>3.1.2.9 Password Flag</li>
<li>3.1.2.10 Keep Alive</li>
<li>3.1.2.11 CONNECT Properties<ul>
<li>3.1.2.11.1 Property Length</li>
<li>3.1.2.11.2 Session Expiry Interval</li>
<li>3.1.2.11.3 Receive Maximum</li>
<li>3.1.2.11.4 Maximum Packet Size</li>
<li>3.1.2.11.5 Topic Alias Maximum</li>
<li>3.1.2.11.6 Request Response Information</li>
<li>3.1.2.11.7 Request Problem Information</li>
<li>3.1.2.11.8 User Property</li>
<li>3.1.2.11.9 Authentication Method</li>
<li>3.1.2.11.10 Authentication Data</li>
</ul>
</li>
<li>3.1.2.12 Variable Header non-normative example</li>
</ul>
</li>
<li>3.1.3 CONNECT Payload<ul>
<li>3.1.3.1 Client Identifier (ClientID)</li>
<li>3.1.3.2 Will Properties<ul>
<li>3.1.3.2.1 Property Length</li>
<li>3.1.3.2.2 Will Delay Interval</li>
<li>3.1.3.2.3 Payload Format Indicator</li>
<li>3.1.3.2.4 Message Expiry Interval</li>
<li>3.1.3.2.5 Content Type</li>
<li>3.1.3.2.6 Response Topic</li>
<li>3.1.3.2.7 Correlation Data</li>
<li>3.1.3.2.8 User Property</li>
</ul>
</li>
<li>3.1.3.3 Will Topic</li>
<li>3.1.3.4 Will Payload</li>
<li>3.1.3.5 User Name</li>
<li>3.1.3.6 Password</li>
</ul>
</li>
<li>3.1.4 CONNECT Actions</li>
</ul>
</li>
<li>3.2 CONNACK – Connect acknowledgement<ul>
<li>3.2.1 CONNACK Fixed Header</li>
<li>3.2.2 CONNACK Variable Header<ul>
<li>3.2.2.1 Connect Acknowledge Flags<ul>
<li>3.2.2.1.1 Session Present</li>
</ul>
</li>
<li>3.2.2.2 Connect Reason Code</li>
<li>3.2.2.3 CONNACK Properties<ul>
<li>3.2.2.3.1 Property Length</li>
<li>3.2.2.3.2 Session Expiry Interval</li>
<li>3.2.2.3.3 Receive Maximum</li>
<li>3.2.2.3.4 Maximum QoS</li>
<li>3.2.2.3.5 Retain Available</li>
<li>3.2.2.3.6 Maximum Packet Size</li>
<li>3.2.2.3.7 Assigned Client Identifier</li>
<li>3.2.2.3.8 Topic Alias Maximum</li>
<li>3.2.2.3.9 Reason String</li>
<li>3.2.2.3.10 User Property</li>
<li>3.2.2.3.11 Wildcard Subscription Available</li>
<li>3.2.2.3.12 Subscription Identifiers Available</li>
<li>3.2.2.3.13 Shared Subscription Available</li>
<li>3.2.2.3.14 Server Keep Alive</li>
<li>3.2.2.3.15 Response Information</li>
<li>3.2.2.3.16 Server Reference</li>
<li>3.2.2.3.17 Authentication Method</li>
<li>3.2.2.3.18 Authentication Data</li>
</ul>
</li>
</ul>
</li>
<li>3.2.3 CONNACK Payload</li>
</ul>
</li>
<li>3.3 PUBLISH – Publish message<ul>
<li>3.3.1 <a href="#3-3-1-PUBLISH-%E5%9B%BA%E5%AE%9A%E5%A4%B4">PUBLISH 固定头</a><ul>
<li>3.3.1.1 DUP</li>
<li>3.3.1.2 QoS</li>
<li>3.3.1.3 RETAIN</li>
<li>3.3.1.4 Remaining Length</li>
</ul>
</li>
<li>3.3.2 PUBLISH Variable Header<ul>
<li>3.3.2.1 Topic Name</li>
<li>3.3.2.2 Packet Identifier</li>
<li>3.3.2.3 PUBLISH Properties<ul>
<li>3.3.2.3.1 Property Length</li>
<li>3.3.2.3.2 Payload Format Indicator</li>
<li>3.3.2.3.3 Message Expiry Interval&#96;</li>
<li>3.3.2.3.4 Topic Alias</li>
<li>3.3.2.3.5 Response Topic</li>
<li>3.3.2.3.6 Correlation Data</li>
<li>3.3.2.3.7 User Property</li>
<li>3.3.2.3.8 Subscription Identifier</li>
<li>3.3.2.3.9 Content Type</li>
</ul>
</li>
</ul>
</li>
<li>3.3.3 PUBLISH Payload</li>
<li>3.3.4 PUBLISH Actions</li>
</ul>
</li>
<li>3.4 PUBACK – Publish acknowledgement<ul>
<li>3.4.1 PUBACK Fixed Header</li>
<li>3.4.2 PUBACK Variable Header<ul>
<li>3.4.2.1 PUBACK Reason Code</li>
<li>3.4.2.2 PUBACK Properties<ul>
<li>3.4.2.2.1 Property Length</li>
<li>3.4.2.2.2 Reason String</li>
<li>3.4.2.2.3 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.4.3 PUBACK Payload</li>
<li>3.4.4 PUBACK Actions</li>
</ul>
</li>
<li>3.5 PUBREC – Publish received (QoS 2 delivery part 1)<ul>
<li>3.5.1 PUBREC Fixed Header</li>
<li>3.5.2 PUBREC Variable Header<ul>
<li>3.5.2.1 PUBREC Reason Code</li>
<li>3.5.2.2 PUBREC Properties<ul>
<li>3.5.2.2.1 Property Length</li>
<li>3.5.2.2.2 Reason String</li>
<li>3.5.2.2.3 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.5.3 PUBREC Payload</li>
<li>3.5.4 PUBREC Actions</li>
</ul>
</li>
<li>3.6 PUBREL – Publish release (QoS 2 delivery part 2)<ul>
<li>3.6.1 PUBREL Fixed Header</li>
<li>3.6.2 PUBREL Variable Header<ul>
<li>3.6.2.1 PUBREL Reason Code</li>
<li>3.6.2.2 PUBREL Properties<ul>
<li>3.6.2.2.1 Property Length</li>
<li>3.6.2.2.2 Reason String</li>
<li>3.6.2.2.3 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.6.3 PUBREL Payload</li>
<li>3.6.4 PUBREL Actions</li>
</ul>
</li>
<li>3.7 PUBCOMP – Publish complete (QoS 2 delivery part 3)<ul>
<li>3.7.1 PUBCOMP Fixed Header</li>
<li>3.7.2 PUBCOMP Variable Header<ul>
<li>3.7.2.1 PUBCOMP Reason Code</li>
<li>3.7.2.2 PUBCOMP Properties<ul>
<li>3.7.2.2.1 Property Length</li>
<li>3.7.2.2.2 Reason String</li>
<li>3.7.2.2.3 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.7.3 PUBCOMP Payload</li>
<li>3.7.4 PUBCOMP Actions</li>
</ul>
</li>
<li>3.8 SUBSCRIBE - Subscribe request<ul>
<li>3.8.1 SUBSCRIBE Fixed Header</li>
<li>3.8.2 SUBSCRIBE Variable Header<ul>
<li>3.8.2.1 SUBSCRIBE Properties<ul>
<li>3.8.2.1.1 Property Length</li>
<li>3.8.2.1.2 Subscription Identifier</li>
<li>3.8.2.1.3 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.8.3 SUBSCRIBE Payload<ul>
<li>3.8.3.1 Subscription Options</li>
</ul>
</li>
<li>3.8.4 SUBSCRIBE Actions</li>
</ul>
</li>
<li>3.9 SUBACK – Subscribe acknowledgement<ul>
<li>3.9.1 SUBACK Fixed Header</li>
<li>3.9.2 SUBACK Variable Header<ul>
<li>3.9.2.1 SUBACK Properties<ul>
<li>3.9.2.1.1 Property Length</li>
<li>3.9.2.1.2 Reason String</li>
<li>3.9.2.1.3 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.9.3 SUBACK Payload</li>
</ul>
</li>
<li>3.10 UNSUBSCRIBE – Unsubscribe request<ul>
<li>3.10.1 UNSUBSCRIBE Fixed Header</li>
<li>3.10.2 UNSUBSCRIBE Variable Header<ul>
<li>3.10.2.1 UNSUBSCRIBE Properties<ul>
<li>3.10.2.1.1 Property Length</li>
<li>3.10.2.1.2 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.10.3 UNSUBSCRIBE Payload</li>
<li>3.10.4 UNSUBSCRIBE Actions</li>
</ul>
</li>
<li>3.11 UNSUBACK – Unsubscribe acknowledgement<ul>
<li>3.11.1 UNSUBACK Fixed Header</li>
<li>3.11.2 UNSUBACK Variable Header<ul>
<li>3.11.2.1 UNSUBACK Properties<ul>
<li>3.11.2.1.1 Property Length</li>
<li>3.11.2.1.2 Reason String</li>
<li>3.11.2.1.3 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.11.3 UNSUBACK Payload</li>
</ul>
</li>
<li>3.12 PINGREQ – PING request<ul>
<li>3.12.1 PINGREQ Fixed Header</li>
<li>3.12.2 PINGREQ Variable Header</li>
<li>3.12.3 PINGREQ Payload</li>
<li>3.12.4 PINGREQ Actions</li>
</ul>
</li>
<li>3.13 PINGRESP – PING response<ul>
<li>3.13.1 PINGRESP Fixed Header</li>
<li>3.13.2 PINGRESP Variable Header</li>
<li>3.13.3 PINGRESP Payload</li>
<li>3.13.4 PINGRESP Actions</li>
</ul>
</li>
<li>3.14 DISCONNECT – Disconnect notification<ul>
<li>3.14.1 DISCONNECT Fixed Header</li>
<li>3.14.2 DISCONNECT Variable Header<ul>
<li>3.14.2.1 Disconnect Reason Code</li>
<li>3.14.2.2 DISCONNECT Properties<ul>
<li>3.14.2.2.1 Property Length</li>
<li>3.14.2.2.2 Session Expiry Interval</li>
<li>3.14.2.2.3 Reason String</li>
<li>3.14.2.2.4 User Property</li>
<li>3.14.2.2.5 Server Reference</li>
</ul>
</li>
</ul>
</li>
<li>3.14.3 DISCONNECT Payload</li>
<li>3.14.4 DISCONNECT Actions</li>
</ul>
</li>
<li>3.15 AUTH – Authentication exchange<ul>
<li>3.15.1 AUTH Fixed Header</li>
<li>3.15.2 AUTH Variable Header<ul>
<li>3.15.2.1 Authenticate Reason Code</li>
<li>3.15.2.2 AUTH Properties<ul>
<li>3.15.2.2.1 Property Length</li>
<li>3.15.2.2.2 Authentication Method</li>
<li>3.15.2.2.3 Authentication Data</li>
<li>3.15.2.2.4 Reason String</li>
<li>3.15.2.2.5 User Property</li>
</ul>
</li>
</ul>
</li>
<li>3.15.3 AUTH Payload</li>
<li>3.15.4 AUTH Actions</li>
</ul>
</li>
</ul>
</li>
<li>4 <a href="#4-%E6%93%8D%E4%BD%9C%E8%A1%8C%E4%B8%BA">操作行为</a><ul>
<li>4.1 Session State<ul>
<li>4.1.1 Storing Session State</li>
<li>4.1.2 Session State non-normative examples</li>
</ul>
</li>
<li>4.2 <a href="#4-2-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5">网络连接</a></li>
<li>4.3 Quality of Service levels and protocol flows<ul>
<li>4.3.1 QoS 0: At most once delivery</li>
<li>4.3.2 QoS 1: At least once delivery</li>
<li>4.3.3 QoS 2: Exactly once delivery</li>
</ul>
</li>
<li>4.4 Message delivery retry</li>
<li>4.5 Message receipt</li>
<li>4.6 Message ordering</li>
<li>4.7 <a href="#4-7-%E4%B8%BB%E9%A2%98%E5%90%8D%E5%92%8C%E4%B8%BB%E9%A2%98%E8%BF%87%E6%BB%A4%E5%99%A8">主题名和主题过滤器</a><ul>
<li>4.7.1 Topic wildcards<ul>
<li>4.7.1.1 Topic level separator</li>
<li>4.7.1.2 Multi-level wildcard</li>
<li>4.7.1.3 Single-level wildcard</li>
</ul>
</li>
<li>4.7.2 Topics beginning with $</li>
<li>4.7.3 Topic semantic and usage</li>
</ul>
</li>
<li>4.8 Subscriptions<ul>
<li>4.8.1 Non‑shared Subscriptions</li>
<li>4.8.2 Shared Subscriptions</li>
</ul>
</li>
<li>4.9 Flow Control</li>
<li>4.10 Request &#x2F; Response<ul>
<li>4.10.1 Basic Request Response (non-normative)</li>
<li>4.10.2 Determining a Response Topic value (non-normative)</li>
</ul>
</li>
<li>4.11 Server redirection</li>
<li>4.12 Enhanced authentication<ul>
<li>4.12.1 Re-authentication</li>
</ul>
</li>
<li>4.13 <a href="#4-13-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">错误处理</a><ul>
<li>4.13.1 Malformed Packet and Protocol Errors</li>
<li>4.13.2 Other errors</li>
</ul>
</li>
</ul>
</li>
<li>5 <a href="#5-%E5%AE%89%E5%85%A8%E6%80%A7%EF%BC%88%E9%9D%9E%E8%A7%84%E8%8C%83%E6%80%A7%EF%BC%89">安全性（非规范性）</a><ul>
<li>5.1 Introduction</li>
<li>5.2 MQTT solutions: security and certification</li>
<li>5.3 Lightweight crytography and constrained devices</li>
<li>5.4 Implementation notes<ul>
<li>5.4.1 Authentication of Clients by the Server</li>
<li>5.4.2 Authorization of Clients by the Server</li>
<li>5.4.3 Authentication of the Server by the Client</li>
<li>5.4.4 Integrity of Application Messages and MQTT Control Packets</li>
<li>5.4.5 Privacy of Application Messages and MQTT Control Packets</li>
<li>5.4.6 Non-repudiation of message transmission</li>
<li>5.4.7 Detecting compromise of Clients and Servers</li>
<li>5.4.8 Detecting abnormal behaviors</li>
<li>5.4.9 <a href="#5-4-9-%E5%A4%84%E7%90%86%E7%A6%81%E6%AD%A2%E7%9A%84Unicode%E7%A0%81%E6%AE%B5">处理禁止的Unicode码段</a><ul>
<li>5.4.9.1 Considerations for the use of Disallowed Unicode code points</li>
<li>5.4.9.2 Interactions between Publishers and Subscribers</li>
<li>5.4.9.3 Remedies</li>
</ul>
</li>
<li>5.4.10 Other security considerations</li>
<li>5.4.11 Use of SOCKS</li>
<li>5.4.12 Security profiles<ul>
<li>5.4.12.1 Clear communication profile</li>
<li>5.4.12.2 Secured network communication profile</li>
<li>5.4.12.3 Secured transport profile</li>
<li>5.4.12.4 Industry specific security profiles</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>6 <a href="#6-%E4%BD%BF%E7%94%A8WebSocket%E4%BD%9C%E4%B8%BA%E4%BC%A0%E8%BE%93%E5%B1%82">使用WebSocket作为传输层</a><ul>
<li>6.1 IANA considerations</li>
</ul>
</li>
<li>7 <a href="#7-%E4%B8%80%E8%87%B4%E6%80%A7">一致性</a><ul>
<li>7.1 Conformance clauses<ul>
<li>7.1.1 MQTT Server conformance clause</li>
<li>7.1.2 MQTT Client conformance clause</li>
</ul>
</li>
</ul>
</li>
<li>Appendix A. Acknowledgments</li>
<li>Appendix B. Mandatory normative statement (non-normative)</li>
<li>附录 C. <a href="#%E9%99%84%E5%BD%95-C-MQTT-v5-0-%E6%96%B0%E7%89%B9%E6%80%A7%E6%B1%87%E6%80%BB%EF%BC%88%E9%9D%9E%E8%A7%84%E8%8C%83%E6%80%A7%EF%BC%89">MQTT v5.0 新特性汇总（非规范性）</a></li>
</ul>
<h1 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1 介绍"></a>1 介绍</h1><h2 id="1-0-知识产权政策"><a href="#1-0-知识产权政策" class="headerlink" title="1.0 知识产权政策"></a>1.0 知识产权政策</h2><p>本规范是在 OASIS <a target="_blank" rel="noopener" href="https://www.oasis-open.org/policies-guidelines/ipr">知识产权政策</a>的 <a target="_blank" rel="noopener" href="https://www.oasis-open.org/policies-guidelines/ipr#Non-Assertion-Mode">Non-Assertion</a>模式下提供的，该模式是技术委员会成立时选择的。关于是否有实施本规范依赖的已经披露的专利信息或是关于任何专利许可条款的信息，请参考技术委员会网站中的知识产权部分(<a target="_blank" rel="noopener" href="https://www.oasis-open.org/committees/mqtt/ipr.php)%E3%80%82">https://www.oasis-open.org/committees/mqtt/ipr.php)。</a></p>
<h2 id="1-1-MQTT规范结构"><a href="#1-1-MQTT规范结构" class="headerlink" title="1.1 MQTT规范结构"></a>1.1 MQTT规范结构</h2><p>本规范分为七个章节：</p>
<ul>
<li>第一章 - <a href="#1-%E4%BB%8B%E7%BB%8D">介绍</a></li>
<li>第二章 - <a href="#2-MQTT%E5%8C%85%E7%BB%93%E6%9E%84">MQTT包格式</a></li>
<li>第三章 - <a href="#3-MQTT%E5%8C%85">MQTT包</a></li>
<li>第四章 - <a href="#4-%E6%93%8D%E4%BD%9C%E8%A1%8C%E4%B8%BA">操作行为</a></li>
<li>第五章 - <a href="#5-%E5%AE%89%E5%85%A8%E6%80%A7%EF%BC%88%E9%9D%9E%E8%A7%84%E8%8C%83%E6%80%A7%EF%BC%89">安全性</a></li>
<li>第六章 - <a href="#6-%E4%BD%BF%E7%94%A8WebSocket%E4%BD%9C%E4%B8%BA%E4%BC%A0%E8%BE%93%E5%B1%82">使用Websocket作为传输层</a></li>
<li>第七章 - <a href="#7-%E4%B8%80%E8%87%B4%E6%80%A7">一致性目标</a></li>
</ul>
<h2 id="1-2-术语表"><a href="#1-2-术语表" class="headerlink" title="1.2 术语表"></a>1.2 术语表</h2><p>本文档中的关键字 “必须(MUST)”，“必须不(MUST NOT)”，“需要(REQUIRED)”，“应该(SHALL)”，“不应该(SHALL NOT)”，“理应(SHOULD)”，“理应不(SHOULD NOT)”，“推荐(RECOMMENDED)”，“也许(MAY)”，和“可选(OPTIONAL)”按照IETF <a href="#1.3-RFC2119">RFC 2119</a>的定义阐释，除非在此类关键字出现的地方明确被标记为非规范性。</p>
<p><strong>网络连接:</strong></p>
<p><strong>由 MQTT 使用的传输协议提供的构造。</strong></p>
<ul>
<li>他在客户端与服务器之间提供连接。</li>
<li>他提供了有序、无丢失、双向传输数据流的能力。</li>
</ul>
<p>参考 <a href="#4-2-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5">4.2 网络连接</a> 中提供的非规范性示例。</p>
<p><strong>应用消息</strong></p>
<p>提供应用程序使用的通过MQTT协议携带的消息。当应用消息通过MQTT传输时，他包含载荷，服务质量，属性集合和主题名称。</p>
<p><strong>客户端</strong></p>
<p>一个使用了 MQTT 的程序或设备。一个客户端往往：</p>
<ul>
<li>打开通往服务端的网络连接</li>
<li>发布其他客户端可能会感兴趣的应用消息</li>
<li>通过订阅来接收自己感兴趣的应用消息</li>
<li>通过取消订阅，不再接收应用消息</li>
<li>关闭通过服务端的网络连接</li>
</ul>
<p><strong>服务器</strong></p>
<p>一个在发布应用消息的客户端和订阅应用消息的客户端之间充当转发中介的程序或设备。一个服务器往往：</p>
<ul>
<li>接收来自客户端的网络连接</li>
<li>接收客户端发布的应用消息</li>
<li>处理客户端的订阅和取消订阅请求</li>
<li>根据客户端的订阅情况匹配转发应用消息</li>
<li>关闭和客户端的网络连接</li>
</ul>
<p><strong>会话</strong></p>
<p>服务器和客户端之间的有状态交互。有些会话仅和单次网络连接持续一样长的时间，有些会话则能够跨越多次连续的网络断开和连接持续保持。</p>
<p><strong>订阅</strong></p>
<p>订阅包括了主题过滤器和最大QoS。订阅只关联到一个会话。一个会话可以包括多个订阅。会话中的每个订阅都拥有一个不同的主题过滤器。</p>
<p><strong>共享订阅</strong></p>
<p>共享订阅包括了主题过滤器和最大QoS。共享订阅可以与多个会话关联，以便使用更加宽泛的信息交换模式。匹配到共享订阅的应用消息只会发送到被关联的会话其中之一对应的客户端。一个会话可以同时持有多个共享订阅，也可以同时持有共享订阅和普通订阅。</p>
<p><strong>通配订阅</strong></p>
<p>通配订阅指的是主题过滤器中包括了一个或多个通配符的订阅。通配订阅允许此订阅匹配多个主题名。参考 <a href="#4-7-%E4%B8%BB%E9%A2%98%E5%90%8D%E5%92%8C%E4%B8%BB%E9%A2%98%E8%BF%87%E6%BB%A4%E5%99%A8">4.7</a> 来了解通配符如何在主题过滤器中起作用。</p>
<p><strong>主题名</strong></p>
<p>附加到应用消息的文字标签，用于与服务器已知的订阅相匹配。</p>
<p><strong>主题过滤器</strong></p>
<p>订阅中包含的一种表达式，用于指示对一个或多个主题的兴趣。主题过滤器可以包含通配符。</p>
<p><strong>MQTT包</strong></p>
<p>通过网络连接发送的数据包。MQTT规范定义了十五中不同类型的MQTT包，例如 <code>发布</code> 包用来承载应用消息。</p>
<p><strong>格式错误的包</strong></p>
<p>一个不能通过本规范解析的数据包。参考 <a href="#4-13-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">4.13</a> 查看关于错误处理的信息。</p>
<p><strong>协议错误</strong></p>
<p>数据包被解析后发现的不符合协议规范的数据内容或客户端与服务器状态不一致的数据。参考 <a href="#4-13-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">4.13</a> 查看关于错误处理的信息。</p>
<p><strong>遗嘱</strong></p>
<p>当网络连接非正常关闭后，由服务端发布的应用消息。参考 <a href="#3-1-2-5-%E9%81%97%E5%98%B1%E6%A0%87%E8%AF%86">3.1.2.5</a> 查看关于遗嘱的消息。</p>
<p><strong>禁止的 Unicode 码段</strong></p>
<p>在 UTF-8 字符串中不应出现的 Unicode 控制代码和 Unicode 非字符集。参考 <a href="#1-5-4-UTF-8%E5%AD%97%E7%AC%A6%E4%B8%B2">1.5.4</a> 查看更多关于禁止的 Unicode 码段的信息。</p>
<h2 id="1-3-规范性引用"><a href="#1-3-规范性引用" class="headerlink" title="1.3 规范性引用"></a>1.3 规范性引用</h2><p><span id="1.3-RFC2119" class="bold">[RFC2119]</span></p>
<p>Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels”, BCP 14, RFC 2119, DOI 10.17487&#x2F;RFC2119, March 1997,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a></p>
<p><span id="1.3-RFC3629" class="bold">[RFC3629]</span></p>
<p>Yergeau, F., “UTF-8, a transformation format of ISO 10646”, STD 63, RFC 3629, DOI 10.17487&#x2F;RFC3629, November 2003,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc3629">http://www.rfc-editor.org/info/rfc3629</a></p>
<p><span id="1.3-RFC6455" class="bold">[RFC6455]</span></p>
<p>Fette, I. and A. Melnikov, “The WebSocket Protocol”, RFC 6455, DOI 10.17487&#x2F;RFC6455, December 2011,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc6455">http://www.rfc-editor.org/info/rfc6455</a></p>
<p><span id="1.3-Unicode" class="bold">[Unicode]</span></p>
<p>The Unicode Consortium. The Unicode Standard,</p>
<p><a target="_blank" rel="noopener" href="http://www.unicode.org/versions/latest/">http://www.unicode.org/versions/latest/</a></p>
<h2 id="1-4-非规范性引用"><a href="#1-4-非规范性引用" class="headerlink" title="1.4 非规范性引用"></a>1.4 非规范性引用</h2><p><span id="1.4-RFC0793" class="bold">[RFC0793]</span></p>
<p>Postel, J., “Transmission Control Protocol”, STD 7, RFC 793, DOI 10.17487&#x2F;RFC0793, September 1981, <a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc793">http://www.rfc-editor.org/info/rfc793</a></p>
<p><span id="1.4-RFC5246" class="bold">[RFC5246]</span></p>
<p>Dierks, T. and E. Rescorla, “The Transport Layer Security (TLS) Protocol Version 1.2”, RFC 5246, DOI 10.17487&#x2F;RFC5246, August 2008,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a></p>
<p><span id="1.4-AES" class="bold">[AES]</span></p>
<p>Advanced Encryption Standard (AES) (FIPS PUB 197).</p>
<p><a target="_blank" rel="noopener" href="https://csrc.nist.gov/csrc/media/publications/fips/197/final/documents/fips-197.pdf">https://csrc.nist.gov/csrc/media/publications/fips/197/final/documents/fips-197.pdf</a></p>
<p><span id="1.4-CHACHA20" class="bold">[CHACHA20]</span></p>
<p>ChaCha20 and Poly1305 for IETF Protocols</p>
<p><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7539">https://tools.ietf.org/html/rfc7539</a></p>
<p><span id="1.4-FIPS1402" class="bold">[FIPS1402]</span></p>
<p>Security Requirements for Cryptographic Modules (FIPS PUB 140-2)</p>
<p><a target="_blank" rel="noopener" href="https://csrc.nist.gov/csrc/media/publications/fips/140/2/final/documents/fips1402.pdf">https://csrc.nist.gov/csrc/media/publications/fips/140/2/final/documents/fips1402.pdf</a></p>
<p><span id="1.4-IEEE 802.1AR" class="bold">[IEEE 802.1AR]</span></p>
<p>IEEE Standard for Local and metropolitan area networks - Secure Device Identity</p>
<p><a target="_blank" rel="noopener" href="http://standards.ieee.org/findstds/standard/802.1AR-2009.html">http://standards.ieee.org/findstds/standard/802.1AR-2009.html</a></p>
<p><span id="1.4-ISO29192" class="bold">[ISO29192]</span></p>
<p>ISO&#x2F;IEC 29192-1:2012 Information technology – Security techniques – Lightweight cryptography – Part 1: General</p>
<p><a target="_blank" rel="noopener" href="https://www.iso.org/standard/56425.html">https://www.iso.org/standard/56425.html</a></p>
<p><span id="1.4-MQTT NIST" class="bold">[MQTT NIST]</span></p>
<p>MQTT supplemental publication, MQTT and the NIST Framework for Improving Critical Infrastructure Cybersecurity</p>
<p><a target="_blank" rel="noopener" href="http://docs.oasis-open.org/mqtt/mqtt-nist-cybersecurity/v1.0/mqtt-nist-cybersecurity-v1.0.html">http://docs.oasis-open.org/mqtt/mqtt-nist-cybersecurity/v1.0/mqtt-nist-cybersecurity-v1.0.html</a></p>
<p><span id="1.4-MQTTV311" class="bold">[MQTTV311]</span></p>
<p>MQTT V3.1.1 Protocol Specification</p>
<p><a target="_blank" rel="noopener" href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html">http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html</a></p>
<p><span id="1.4-ISO20922" class="bold">[ISO20922]</span></p>
<p>MQTT V3.1.1 ISO Standard (ISO&#x2F;IEC 20922:2016)</p>
<p><a target="_blank" rel="noopener" href="https://www.iso.org/standard/69466.html">https://www.iso.org/standard/69466.html</a></p>
<p><span id="1.4-NISTCSF" class="bold">[NISTCSF]</span></p>
<p>Improving Critical Infrastructure Cybersecurity Executive Order 13636</p>
<p><a target="_blank" rel="noopener" href="https://www.nist.gov/sites/default/files/documents/itl/preliminary-cybersecurity-framework.pdf">https://www.nist.gov/sites/default/files/documents/itl/preliminary-cybersecurity-framework.pdf</a></p>
<p><span id="1.4-NIST7628" class="bold">[NIST7628]</span></p>
<p>NISTIR 7628 Guidelines for Smart Grid Cyber Security Catalogue</p>
<p><a target="_blank" rel="noopener" href="https://www.nist.gov/sites/default/files/documents/smartgrid/nistir-7628_total.pdf">https://www.nist.gov/sites/default/files/documents/smartgrid/nistir-7628_total.pdf</a></p>
<p><span id="1.4-NSAB" class="bold">[NSAB]</span></p>
<p>NSA Suite B Cryptography</p>
<p><a target="_blank" rel="noopener" href="http://www.nsa.gov/ia/programs/suiteb_cryptography/">http://www.nsa.gov/ia/programs/suiteb_cryptography/</a></p>
<p><span id="1.4-PCIDSS" class="bold">[PCIDSS]</span></p>
<p>PCI-DSS Payment Card Industry Data Security Standard</p>
<p><a target="_blank" rel="noopener" href="https://www.pcisecuritystandards.org/pci_security/">https://www.pcisecuritystandards.org/pci_security/</a></p>
<p><span id="1.4-RFC1928" class="bold">[RFC1928]</span></p>
<p>Leech, M., Ganis, M., Lee, Y., Kuris, R., Koblas, D., and L. Jones, “SOCKS Protocol Version 5”, RFC 1928, DOI 10.17487&#x2F;RFC1928, March 1996,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc1928">http://www.rfc-editor.org/info/rfc1928</a></p>
<p><span id="1.4-RFC4511" class="bold">[RFC4511]</span></p>
<p>Sermersheim, J., Ed., “Lightweight Directory Access Protocol (LDAP): The Protocol”, RFC 4511, DOI 10.17487&#x2F;RFC4511, June 2006,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc4511">http://www.rfc-editor.org/info/rfc4511</a></p>
<p><span id="1.4-RFC5280" class="bold">[RFC5280]</span></p>
<p>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, “Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile”, RFC 5280, DOI 10.17487&#x2F;RFC5280, May 2008,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc5280">http://www.rfc-editor.org/info/rfc5280</a></p>
<p><span id="1.4-RFC6066" class="bold">[RFC6066]</span></p>
<p>Eastlake 3rd, D., “Transport Layer Security (TLS) Extensions: Extension Definitions”, RFC 6066, DOI 10.17487&#x2F;RFC6066, January 2011,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc6066">http://www.rfc-editor.org/info/rfc6066</a></p>
<p><span id="1.4-RFC6749" class="bold">[RFC6749]</span></p>
<p>Hardt, D., Ed., “The OAuth 2.0 Authorization Framework”, RFC 6749, DOI 10.17487&#x2F;RFC6749, October 2012,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc6749">http://www.rfc-editor.org/info/rfc6749</a></p>
<p><span id="1.4-RFC6960" class="bold">[RFC6960]</span></p>
<p>Santesson, S., Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, “X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP”, RFC 6960, DOI 10.17487&#x2F;RFC6960, June 2013,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc6960">http://www.rfc-editor.org/info/rfc6960</a></p>
<p><span id="1.4-SARBANES" class="bold">[SARBANES]</span></p>
<p>Sarbanes-Oxley Act of 2002.</p>
<p><a target="_blank" rel="noopener" href="http://www.gpo.gov/fdsys/pkg/PLAW-107publ204/html/PLAW-107publ204.htm">http://www.gpo.gov/fdsys/pkg/PLAW-107publ204/html/PLAW-107publ204.htm</a></p>
<p><span id="1.4-USEUPRIVSH" class="bold">[USEUPRIVSH]</span></p>
<p>U.S.-EU Privacy Shield Framework</p>
<p><a target="_blank" rel="noopener" href="https://www.privacyshield.gov/">https://www.privacyshield.gov</a></p>
<p><span id="1.4-RFC3986" class="bold">[RFC3986]</span></p>
<p>Berners-Lee, T., Fielding, R., and L. Masinter, “Uniform Resource Identifier (URI): Generic Syntax”, STD 66, RFC 3986, DOI 10.17487&#x2F;RFC3986, January 2005,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc3986">http://www.rfc-editor.org/info/rfc3986</a></p>
<p><span id="1.4-RFC1035" class="bold">[RFC1035]</span></p>
<p>Mockapetris, P., “Domain names - implementation and specification”, STD 13, RFC 1035, DOI 10.17487&#x2F;RFC1035, November 1987,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc1035">http://www.rfc-editor.org/info/rfc1035</a></p>
<p><span id="1.4-RFC2782" class="bold">[RFC2782]</span></p>
<p>Gulbrandsen, A., Vixie, P., and L. Esibov, “A DNS RR for specifying the location of services (DNS SRV)”, RFC 2782, DOI 10.17487&#x2F;RFC2782, February 2000,</p>
<p><a target="_blank" rel="noopener" href="http://www.rfc-editor.org/info/rfc2782">http://www.rfc-editor.org/info/rfc2782</a></p>
<h2 id="1-5-数据表示"><a href="#1-5-数据表示" class="headerlink" title="1.5 数据表示"></a>1.5 数据表示</h2><h3 id="1-5-1-比特位"><a href="#1-5-1-比特位" class="headerlink" title="1.5.1 比特位"></a>1.5.1 比特位</h3><p>字节中的比特位被标记为7-0，最高位为7，最低位为0。</p>
<h3 id="1-5-2-2字节整数"><a href="#1-5-2-2字节整数" class="headerlink" title="1.5.2 2字节整数"></a>1.5.2 2字节整数</h3><p>2字节整数指16位的大端表示的无符号整数：高位字节在低位字节之前。这意味着在网络中传输的2字节整数先传输高有效字节(MSB)，后传输低有效字节(LSB)。</p>
<h3 id="1-5-3-4字节整数"><a href="#1-5-3-4字节整数" class="headerlink" title="1.5.3 4字节整数"></a>1.5.3 4字节整数</h3><p>4字节整数指32位的大端表示的无符号整数：高位字节先于连续的低位字节。这意味着在网络中传输的4字节整数先传输最高有效字节(MSB)，再传输次高有效字节(MSB)，再传输次高有效字节(MSB)，最后传输低有效字节(LSB)。</p>
<h3 id="1-5-4-UTF-8字符串"><a href="#1-5-4-UTF-8字符串" class="headerlink" title="1.5.4 UTF-8字符串"></a>1.5.4 UTF-8字符串</h3><p>MQTT包中使用的文本类型字段均采用 UTF-8 编码。UTF-8 <a href="#1.3-RFC3629">RFC3629</a> 是一种高效的 <a href="#1.3-Unicode">Unicode</a> 编码，他优化了 ACSII 的编码以用来支持基于文本的通信。</p>
<p>每个 UTF-8 编码的字符串都使用开头的两个字节表示字符串的长度，就像下方的 <span class="vcLinked">图1-1 UTF-8 字符串结构</span> 示意的那样。因此，UTF-8 字符串的最大长度为65535字节。</p>
<p>除非另有说明，否则所有 UTF-8 编码字符串可以具有 0 到 65,535 字节范围内的任意长度。</p>
<p>图1-1 UTF-8 字符串结构</p>
<table>
    <tr>
        <th>Bit</th>
        <th>7</th>
        <th>6</th>
        <th>5</th>
        <th>4</th>
        <th>3</th>
        <th>2</th>
        <th>1</th>
        <th>0</th>
    </tr>
    <tr>
        <td>byte 1</td>
        <td colspan="8">字符串长度高字节(MSB)</td>
    </tr>
    <tr>
        <td>byte 2</td>
        <td colspan="8">字符串长度低字节(LSB)</td>
    </tr>
    <tr>
        <td>byte 3 ...</td>
        <td colspan="8">当长度 > 0 时, UTF-8 编码的字符数据</td>
    </tr>
</table>

<p><span class="vcMarked">在 UTF-8 编码字符串中的字符必须为 <a href="#1.3-Unicode">[Unicode]</a> 和 <a href="#1.3-RFC3629">[RFC3629]</a> 中所定义的，格式正确的字符编码。尤其不能使用U+D800 至 U+DFFF之间的编码</span> <span class="vcReferred">[MQTT-1.5.4-1]</span>。如果客户端或服务器接收到的 MQTT 包中包括了非法 UTF-8 编码，将其视为一个格式错误的包。参考 <a href="#4-13-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">4.13</a> 查看关于错误处理的信息。</p>
<p><span class="vcMarked">UTF-8 编码字符串必须不包含空字符 U+0000</span> <span class="vcReferred">[MQTT-1.5.4-2]</span>。如果一个接收者（服务器或客户端）接收的 MQTT 包其中有空字符 U+0000 ，将其视为一个格式错误的包。参考 <a href="#4-13-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">4.13</a> 查看关于错误处理的信息。</p>
<p>数据不应该包括下方列表中的 Unicode 码段，如果一个接收者（服务器或客户端）接受的 MQTT 包其中有此类字符，接收者可以将此包视为一个格式错误的包。这些是禁止使用的 Unicode 码段。参考 <a href="#5-4-9-%E5%A4%84%E7%90%86%E7%A6%81%E6%AD%A2%E7%9A%84Unicode%E7%A0%81%E6%AE%B5">5.4.9</a> 查看关于错误处理的信息。</p>
<ul>
<li>U+0001..U+001F 控制字符</li>
<li>U+007F..U+009F 控制字符</li>
<li><a href="#1.3-Unicode">Unicode</a> 规范中定义的非文本字符（例如 U+0FFFF）</li>
</ul>
<p><span class="vcMarked">无论 UTF-8 编码序列 0xEF 0xBB 0xBF 出现在字符串的何处，他永远被解释为 U+FEFF (0宽无换行空格) 而且不能被数据包的接收者跳过或剥离</span> <span class="vcReferred">[MQTT-1.5.4-3]</span>。</p>
<p><strong>非规范性示例</strong></p>
<p>例如，字符串 A𪛔 的第一个字符是拉丁文大写字母A，第二个字符是码点 U+2A6D4 （代表 CJK IDEOGRAPH EXTENSION B 字符），他是这样编码的：</p>
<p>图1‑2 UTF-8 编码字符串非规范性示例</p>
<table>
    <tr>
        <th>Bit</th>
        <th>7</th>
        <th>6</th>
        <th>5</th>
        <th>4</th>
        <th>3</th>
        <th>2</th>
        <th>1</th>
        <th>0</th>
    </tr>
    <tr>
        <td>byte 1</td>
        <td colspan="8">字符串长度高字节(MSB)(0x00)</td>
    </tr>
    <tr>
        <td></td>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
    </tr>
    <tr>
        <td>byte 2</td>
        <td colspan="8">字符串长度低字节(LSB)(0x05)</td>
    </tr>
    <tr>
        <td></td>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
    </tr>
    <tr>
        <td>byte 3</td>
        <td colspan="8">‘A’ (0x41)</td>
    </tr>
    <tr>
        <td></td>
        <th>0</th>
        <th>1</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>1</th>
    </tr>
    <tr>
        <td>byte 4</td>
        <td colspan="8">(0xF0)</td>
    </tr>
    <tr>
        <td></td>
        <th>1</th>
        <th>1</th>
        <th>1</th>
        <th>1</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
        <th>0</th>
    </tr>
    <tr>
        <td>byte 5</td>
        <td colspan="8">(0xAA)</td>
    </tr>
    <tr>
        <td></td>
        <th>1</th>
        <th>0</th>
        <th>1</th>
        <th>0</th>
        <th>1</th>
        <th>0</th>
        <th>1</th>
        <th>0</th>
    </tr>
    <tr>
        <td>byte 6</td>
        <td colspan="8">(0x9B)</td>
    </tr>
    <tr>
        <td></td>
        <th>1</th>
        <th>0</th>
        <th>0</th>
        <th>1</th>
        <th>1</th>
        <th>0</th>
        <th>1</th>
        <th>1</th>
    </tr>
    <tr>
        <td>byte 7</td>
        <td colspan="8">(0x94)</td>
    </tr>
    <tr>
        <td></td>
        <th>1</th>
        <th>0</th>
        <th>0</th>
        <th>1</th>
        <th>0</th>
        <th>1</th>
        <th>0</th>
        <th>0</th>
    </tr>
</table>

<h3 id="1-5-5-变长整数"><a href="#1-5-5-变长整数" class="headerlink" title="1.5.5 变长整数"></a>1.5.5 变长整数</h3><p>变长整数中将一个字节的最大值视为 127，更大的值采用如下方式处理。每个字节中较低的七位用来存储数字的值，最高位用来表示是否有后续的字节。因此，每个字节都编码了128个可能的值和一个 “后续位”。变长整数的最大字节数是4。<span class="vcMarked">变长整数编码时必须使用能够表示数字值的最小长度来进行编码</span> <span class="vcReferred">[MQTT-1.5.5-1]</span>。表1-1 中展示了变长整数可以表示的值。</p>
<p>表1-1 变长整数的值</p>
<table>
<thead>
<tr>
<th>位数</th>
<th>最小值</th>
<th>最大值</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>0 (0x00)</td>
<td>127 (0x7F)</td>
</tr>
<tr>
<td>2</td>
<td>128 (0x80, 0x01)</td>
<td>16,383 (0xFF, 0x7F)</td>
</tr>
<tr>
<td>3</td>
<td>16,384 (0x80, 0x80, 0x01)</td>
<td>2,097,151 (0xFF, 0xFF, 0x7F)</td>
</tr>
<tr>
<td>4</td>
<td>2,097,152 (0x80, 0x80, 0x80, 0x01)</td>
<td>268,435,455 (0xFF, 0xFF, 0xFF, 0x7F)</td>
</tr>
</tbody></table>
<p><strong>非规范性示例</strong></p>
<p>将非负整数 X 编码为变长整数的伪代码：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">do
   encodedByte = X MOD 128
   X = X DIV 128
   // if there are more data to encode, set the top bit of this byte
   if (X > 0)
      encodedByte = encodedByte OR 128
   endif
   'output' encodedByte
while (X > 0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>上例中的 MOD 表示取模（C语言中的 %），DIV表示整数除法（C语言中的 &#x2F;），OR表示位运算中的或（C语言中的 |）。</p>
<p><strong>非规范性示例</strong></p>
<p>解码变长整数的伪代码：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">multiplier = 1
value = 0
do
   encodedByte = 'next byte from stream'
   value += (encodedByte AND 127) * multiplier
   if (multiplier > 128*128*128)
      throw Error(Malformed Variable Byte Integer)
   multiplier *= 128
while ((encodedByte AND 128) != 0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>上例中的 AND 表示位运算中的且（C语言中的 &amp;）。</p>
<p>当该算法完成时，value的值即是变长整数表示的值。</p>
<h3 id="1-5-6-二进制数据"><a href="#1-5-6-二进制数据" class="headerlink" title="1.5.6 二进制数据"></a>1.5.6 二进制数据</h3><p>二进制数据由2字节整数表示的字节流长度加上实际的字节流内容组成。因此，二进制数据的长度范围是 0-65535 字节。</p>
<h3 id="1-5-7-UTF-8字符串对"><a href="#1-5-7-UTF-8字符串对" class="headerlink" title="1.5.7 UTF-8字符串对"></a>1.5.7 UTF-8字符串对</h3><p>UT-8 字符串对包括两个 UTF-8 编码的字符串。这种数据类型用来存储 键-值 对。第一个字符串表示键，第二个字符串表示值。</p>
<p><span class="vcMarked">UTF-8字符串对中的两个字符串都必须遵守 UTF-8 字符串的需求</span> <span class="vcReferred">[MQTT-1.5.7-1]</span>。如果一个接收者（客户端或服务器）接收到的键值对没有遵守这些需求，则被视为一个格式错误的数据包。参考 <a href="#4-13-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">4.13</a> 查看关于错误处理的信息。</p>
<h2 id="1-6-安全性"><a href="#1-6-安全性" class="headerlink" title="1.6 安全性"></a>1.6 安全性</h2><p>MQTT 的客户端和服务器实现应该提供认证、授权和加密传输选项，这一部分在第五章讨论。强烈建议与关键基础设施、个人身份信息或其他个人或敏感信息相关的应用程序使用这些安全功能。</p>
<h2 id="1-7-编辑约定"><a href="#1-7-编辑约定" class="headerlink" title="1.7 编辑约定"></a>1.7 编辑约定</h2><p>本规范中以<span class="vcMarked">黄色</span>突出显示的文本标识了一致性声明。每个一致性声明都被分配了一个格式为 <span class="vcReferred">[MQTT-x.x.x-y]</span> 的引用，其中 <span class="vcReferred">x.x.x</span> 是章节序号，<span class="vcReferred">y</span> 是章节内的序号。</p>
<h2 id="1-8-变更历史"><a href="#1-8-变更历史" class="headerlink" title="1.8 变更历史"></a>1.8 变更历史</h2><h3 id="1-8-1-MQTT-v3-1-1"><a href="#1-8-1-MQTT-v3-1-1" class="headerlink" title="1.8.1 MQTT v3.1.1"></a>1.8.1 MQTT v3.1.1</h3><p>MQTT v3.1.1 是 OASIS 提出的第一个 MQTT 标准 <strong>[MQTTV311]</strong> 。</p>
<p>MQTT v3.1.1 同时也是 ISO&#x2F;IEC 20922:2016 标准 <a href="#1.4-ISO20922">ISO20922</a>。</p>
<h3 id="1-8-2-MQTT-v5-0"><a href="#1-8-2-MQTT-v5-0" class="headerlink" title="1.8.2 MQTT v5.0"></a>1.8.2 MQTT v5.0</h3><p>MQTT v5.0 为 MQTT 添加了大量新功能，同时保留了大部分核心功能。主要功能目标是：</p>
<ul>
<li>可扩展性和大型系统的增强</li>
<li>改进错误报告能力</li>
<li>将常见用法规范化，包括功能发现和请求响应</li>
<li>包括用户属性在内的拓展机制</li>
<li>性能改进，增强对小型客户端的支持</li>
</ul>
<p>参考 <a href="#%E9%99%84%E5%BD%95-C-MQTT-v5-0-%E6%96%B0%E7%89%B9%E6%80%A7%E6%B1%87%E6%80%BB%EF%BC%88%E9%9D%9E%E8%A7%84%E8%8C%83%E6%80%A7%EF%BC%89">附录 C</a> 查阅 MQTT v5.0 的变更汇总。</p>
<h1 id="2-MQTT包格式"><a href="#2-MQTT包格式" class="headerlink" title="2 MQTT包格式"></a>2 MQTT包格式</h1><h2 id="2-1-MQTT包结构"><a href="#2-1-MQTT包结构" class="headerlink" title="2.1 MQTT包结构"></a>2.1 MQTT包结构</h2><p>MQTT 协议操作通过一系列的 MQTT 包交互来实现。本章用来描述这些 MQTT 包的结构。</p>
<p>一个 MQTT 包由三部分构成，顺序固定，参考下图：</p>
<table>
  <tr><td>固定头，所有的 MQTT 包都必须持有</td><tr>
  <tr><td>可变头，部分 MQTT 包持有</td></tr>
  <tr><td>载荷，部分 MQTT 包持有</td></tr>
</table>

<h3 id="2-1-1-固定头"><a href="#2-1-1-固定头" class="headerlink" title="2.1.1 固定头"></a>2.1.1 固定头</h3><p>每个 MQTT 包都包含着一个下图所示的固定头：</p>
<p>图2-2 固定头格式</p>
<table>
    <tr>
        <th>Bit</th>
        <th>7</th>
        <th>6</th>
        <th>5</th>
        <th>4</th>
        <th>3</th>
        <th>2</th>
        <th>1</th>
        <th>0</th>
    </tr>
    <tr>
        <td>byte 1</td>
        <td colspan="4">MQTT包类型</td>
        <td colspan="4">针对不同包类型的控制标识</td>
    </tr>
    <tr>
        <td>byte 2...</td>
        <td colspan="8">剩余长度</td>
    </tr>
</table>

<h3 id="2-1-2-MQTT包类型"><a href="#2-1-2-MQTT包类型" class="headerlink" title="2.1.2 MQTT包类型"></a>2.1.2 MQTT包类型</h3><p><strong>位置：</strong>第一个Byte，比特位7-4。</p>
<p>表示为 4bit 的无符号整数，数值的含义如下表所示：</p>
<p>表2-1 MQTT包类型</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
<th>Direction of flow</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>保留</td>
<td>0</td>
<td>禁止</td>
<td>保留</td>
</tr>
<tr>
<td>CONNECT</td>
<td>1</td>
<td>客户端到服务器</td>
<td>连接请求</td>
</tr>
<tr>
<td>CONNACK</td>
<td>2</td>
<td>服务器到客户端</td>
<td>连接回复</td>
</tr>
<tr>
<td>PUBLISH</td>
<td>3</td>
<td>双向</td>
<td>消息发布</td>
</tr>
<tr>
<td>PUBACK</td>
<td>4</td>
<td>双向</td>
<td>消息回复（QoS1）</td>
</tr>
<tr>
<td>PUBREC</td>
<td>5</td>
<td>双向</td>
<td>消息已接收（QoS2交付第 1 部分）</td>
</tr>
<tr>
<td>PUBREL</td>
<td>6</td>
<td>双向</td>
<td>消息释放（QoS2交付第 2 部分）</td>
</tr>
<tr>
<td>PUBCOMP</td>
<td>7</td>
<td>双向</td>
<td>消息完成（QoS2交付第 3 部分）</td>
</tr>
<tr>
<td>SUBSCRIBE</td>
<td>8</td>
<td>客户端到服务器</td>
<td>订阅请求</td>
</tr>
<tr>
<td>SUBACK</td>
<td>9</td>
<td>服务器到客户端</td>
<td>订阅回复</td>
</tr>
<tr>
<td>UNSUBSCRIBE</td>
<td>10</td>
<td>客户端到服务器</td>
<td>取消订阅请求</td>
</tr>
<tr>
<td>UNSUBACK</td>
<td>11</td>
<td>服务器到客户端</td>
<td>取消订阅回复</td>
</tr>
<tr>
<td>PINGREQ</td>
<td>12</td>
<td>客户端到服务器</td>
<td>PING 请求</td>
</tr>
<tr>
<td>PINGRESP</td>
<td>13</td>
<td>服务器到客户端</td>
<td>PING 响应</td>
</tr>
<tr>
<td>DISCONNECT</td>
<td>14</td>
<td>双向</td>
<td>断开连接通知</td>
</tr>
<tr>
<td>AUTH</td>
<td>15</td>
<td>双向</td>
<td>认证交换</td>
</tr>
</tbody></table>
<h3 id="2-1-3-控制标识"><a href="#2-1-3-控制标识" class="headerlink" title="2.1.3 控制标识"></a>2.1.3 控制标识</h3><p>固定头第一个 byte 中剩下的四个bit [3-0]包括了基于不同 MQTT 包类型的控制标识。<span class="vcMarked">当一个比特位被标记为 “保留” 时，他的意义被保留到未来使用而他的值必须按照下表设置</span> <span class="vcReferred">[MQTT-2.1.3-1]</span>。如果接收到的控制标志不符合规范，则被认为是一个格式错误的数据包。参考 <a href="#4-13-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">4.13</a> 查看关于错误处理的信息。</p>
<p>表2‑2 控制标志</p>
<table>
  <thead>
    <td>MQTT包</td>
    <td>控制标志</td>
    <td>Bit 3</td>
    <td>Bit 2</td>
    <td>Bit 1</td>
    <td>Bit 0</td>
  </thead>
  <tr>
    <td>CONNECT</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>CONNACK</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>PUBLISH</td>
    <td>MQTT 5.0版本使用</td>
    <td>DUP</td>
    <td colspan="2">QoS</td>
    <td>RETAIN</td>
  </tr>
  <tr>
    <td>PUBACK</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>PUBREC</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>PUBREL</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>1</td>
    <td>0</td>
  </tr>
  <tr>
    <td>PUBCOMP</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>SUBSCRIBE</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>1</td>
    <td>0</td>
  </tr>
  <tr>
    <td>SUBACK</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>UNSUBSCRIBE</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>1</td>
    <td>0</td>
  </tr>
  <tr>
    <td>UNSUBACK</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>PINGREQ</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>PINGRESP</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>DISCONNECT</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
  <tr>
    <td>AUTH</td>
    <td>Reserved</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
    <td>0</td>
  </tr>
</table>

<p>DUP &#x3D; 重复发送的 PUBLISH 包<br>QoS &#x3D; PUBLISH 包的服务质量标识<br>RETAIN &#x3D; PUBLISH 保留信息标识</p>
<p>参考 <a href="#3-3-1-PUBLISH-%E5%9B%BA%E5%AE%9A%E5%A4%B4">3.3.1</a> 了解更多关于 DUP，QoS 和 RETAIN 标识在 PUBLISH 中的使用方式。</p>
<h3 id="2-1-4-剩余长度"><a href="#2-1-4-剩余长度" class="headerlink" title="2.1.4 剩余长度"></a>2.1.4 剩余长度</h3><p><strong>位置：</strong>从第二个Byte开始。</p>
<p>剩余长度是一个变长整数，用来表示当前包剩余的字节数，包括可变头和载荷。剩余长度的值不包括剩余长度自己本身占用的字节数。一个 MQTT 包完整的字节数等于固定头的长度加上剩余长度的值。</p>
<h2 id="2-2-可变头"><a href="#2-2-可变头" class="headerlink" title="2.2 可变头"></a>2.2 可变头</h2><p>某些类型的 MQTT 包包含可变头。他位于固定头和载荷之间。可变头的内容根据数据包的类型变化。可变头中的包ID字段多种类型的数据包中都存在。</p>
<h3 id="2-2-1-包ID"><a href="#2-2-1-包ID" class="headerlink" title="2.2.1 包ID"></a>2.2.1 包ID</h3><p>很多类型的 MQTT 包都在其可变头中包含了 2byte 的包ID字段。这些 MQTT 包是 PUBLISH （当 QoS &gt; 0时），PUBACK，PUBREC，PUBREL，PUBCOMP，SUBSCRIBE，SUBACK，UNSUBSCRIBE，UNSUBACK。</p>
<p>需要包ID的 MQTT 包类型如下表所示：</p>
<p>表2-3 包含包ID的 MQTT 包类型</p>
<table>
<thead>
<tr>
<th>MQTT 包</th>
<th>包ID字段</th>
</tr>
</thead>
<tbody><tr>
<td>CONNECT</td>
<td>否</td>
</tr>
<tr>
<td>CONNACK</td>
<td>否</td>
</tr>
<tr>
<td>PUBLISH</td>
<td>是（仅当 QoS &gt; 0 时）</td>
</tr>
<tr>
<td>PUBACK</td>
<td>是</td>
</tr>
<tr>
<td>PUBREC</td>
<td>是</td>
</tr>
<tr>
<td>PUBREL</td>
<td>是</td>
</tr>
<tr>
<td>PUBCOMP</td>
<td>是</td>
</tr>
<tr>
<td>SUBSCRIBE</td>
<td>是</td>
</tr>
<tr>
<td>SUBACK</td>
<td>是</td>
</tr>
<tr>
<td>UNSUBSCRIBE</td>
<td>是</td>
</tr>
<tr>
<td>UNSUBACK</td>
<td>是</td>
</tr>
<tr>
<td>PINGREQ</td>
<td>否</td>
</tr>
<tr>
<td>PINGRESP</td>
<td>否</td>
</tr>
<tr>
<td>DISCONNECT</td>
<td>否</td>
</tr>
<tr>
<td>AUTH</td>
<td>否</td>
</tr>
</tbody></table>
<p><span class="vcMarked">当 PUBLISH 包的 QoS 值为 0 时，必须不包含 包ID 字段</span> <span class="vcReferred">[MQTT-2.2.1-2]</span>。</p>
<p><span class="vcMarked">每当客户端发送新的 SUBSCRIBE包，UNSUBSCRIBE包 或 QoS &gt; 0 的 PUBLISH包，必须携带一个非零且当前未被使用的 包ID</span> <span class="vcReferred">[MQTT-2.2.1-3]</span>。</p>
<p><span class="vcMarked">每当服务端发送新的 QoS &gt; 0 的 PUBLISH包，必须携带一个非零且当前未被使用的 包ID</span> <span class="vcReferred">[MQTT-2.2.1-4]</span>。</p>
<p>包ID仅在发送者处理了对应的回复后可重新使用，定义如下。对于 QoS &#x3D; 1 的 PUBLISH，对应的回复是 PUBACK；对于 QoS &#x3D; 2 的PUBLISH，对应的回复是 PUBCOMP 或当原因码为 128 或更大时为 PUBREC。对于 SUBSCRIBE 或 UNSUBSCRIBE，对应的回复是 SUBACK 或 UNSUBACK。</p>
<p>在一个会话中，客户端与服务器分别使用一个单独、统一的集合用作提供 PUBLISH、SUBSCRIBE 和 UNSUBSCRIBE 的包ID。包ID在任何时候都不能被多个命令使用。</p>
<p><span class="vcMarked">PUBACK，PUBREC，PUBREL 或 PUBCOMP 包必须携带和 PUBLISH 相同的 包ID</span> <span class="vcReferred">[MQTT-2.2.1-5]</span>。<span class="vcMarked">SUBACK 和 UNSUBACK 必须携带和其对应的 SUBSCRIBE 和 UNSUBSCRIBE 包相同的包ID</span> <span class="vcReferred">[MQTT-2.2.1-6]</span>。</p>
<p>客户端与服务器各自独立的维护包ID分配。因此，客户端与服务器可以同时使用同样的包ID发送信息。</p>
<p><strong>非规范性示例</strong></p>
<p>客户端发送一个包ID为 0x1234 的 PUBLISH 包，之后在其接收到对应的 PUBACK 之前，从服务器接收到一个 包ID 为 0x1234 的 PUBLISH 包。这样的情况是合理而且完全有可能的。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">Client                                                   Server
PUBLISH 包ID=0x1234 ‒→
                                                    ←‒ PUBLISH 包ID=0x1234
PUBACK 包ID=0x1234 ‒→
                                                    ←‒ PUBACK 包ID=0x1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="3-MQTT包"><a href="#3-MQTT包" class="headerlink" title="3 MQTT包"></a>3 MQTT包</h1><h4 id="3-1-2-5-遗嘱标识"><a href="#3-1-2-5-遗嘱标识" class="headerlink" title="3.1.2.5 遗嘱标识"></a>3.1.2.5 遗嘱标识</h4><h3 id="3-3-1-PUBLISH-固定头"><a href="#3-3-1-PUBLISH-固定头" class="headerlink" title="3.3.1 PUBLISH 固定头"></a>3.3.1 PUBLISH 固定头</h3><h1 id="4-操作行为"><a href="#4-操作行为" class="headerlink" title="4 操作行为"></a>4 操作行为</h1><h2 id="4-2-网络连接"><a href="#4-2-网络连接" class="headerlink" title="4.2 网络连接"></a>4.2 网络连接</h2><h2 id="4-7-主题名和主题过滤器"><a href="#4-7-主题名和主题过滤器" class="headerlink" title="4.7 主题名和主题过滤器"></a>4.7 主题名和主题过滤器</h2><h2 id="4-13-错误处理"><a href="#4-13-错误处理" class="headerlink" title="4.13 错误处理"></a>4.13 错误处理</h2><h1 id="5-安全性（非规范性）"><a href="#5-安全性（非规范性）" class="headerlink" title="5 安全性（非规范性）"></a>5 安全性（非规范性）</h1><h3 id="5-4-9-处理禁止的Unicode码段"><a href="#5-4-9-处理禁止的Unicode码段" class="headerlink" title="5.4.9 处理禁止的Unicode码段"></a>5.4.9 处理禁止的Unicode码段</h3><h1 id="6-使用WebSocket作为传输层"><a href="#6-使用WebSocket作为传输层" class="headerlink" title="6 使用WebSocket作为传输层"></a>6 使用WebSocket作为传输层</h1><h1 id="7-一致性"><a href="#7-一致性" class="headerlink" title="7 一致性"></a>7 一致性</h1><h1 id="附录-C-MQTT-v5-0-新特性汇总（非规范性）"><a href="#附录-C-MQTT-v5-0-新特性汇总（非规范性）" class="headerlink" title="附录 C. MQTT v5.0 新特性汇总（非规范性）"></a>附录 C. MQTT v5.0 新特性汇总（非规范性）</h1>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/MQTT/" class="category-chain-item">MQTT</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/MQTT/" class="print-no-link">#MQTT</a>
      
        <a href="/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" class="print-no-link">#网络协议</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MQTT 5.0 中文文档(施工中)</div>
      <div>https://vitsumoc.github.io/2024/01/06/mqtt-v5-0-chinese.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>vc</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年1月6日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/01/04/gookit-event.html" title="go轻量级事件库：gookit-event">
                        <span class="hidden-mobile">go轻量级事件库：gookit-event</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <span>vitusmoc Blog, Powered by </span> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
